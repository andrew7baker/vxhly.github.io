(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{477:function(s,t,a){"use strict";a.r(t);var e=a(4),r=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("div",{staticClass:"custom-block tip"},[a("p",[s._v("本系列笔记又是 Liunx 学习系列教程的一大步, 本系列学习笔记记录 RedHat 系统的安全加固。 本篇主要介绍相关于帐号安全的加固策略, 加强系统的防御能力")])]),s._v(" "),a("h2",{attrs:{id:"密码规则"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#密码规则"}},[s._v("#")]),s._v(" 密码规则")]),s._v(" "),a("h3",{attrs:{id:"密码长度和有效期"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#密码长度和有效期"}},[s._v("#")]),s._v(" 密码长度和有效期")]),s._v(" "),a("p",[a("strong",[s._v("/etc/login.defs")]),s._v(" 文件是当创建用户时的一些规划, 比如创建用户时, 是否需要家目录, UID 和 GID 的范围; 用户的期限等等, 这个文件是可以通过 "),a("code",[s._v("root")]),s._v(" 来定义的")]),s._v(" "),a("p",[a("code",[s._v("Default Configuration:")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("PASS_MAX_DAYS 99999# 两次改变密码之间相距的最大天数, 密码有效最大天数\nPASS_MIN_DAYS 0# 两次改变密码之间相距的最小天数, 为零时代表任何时候都可以更改密码\nPASS_MIN_LEN 5# 密码最小长度\nPASS_WARN_AGE 7# 在密码过期之前警告的天数\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("div",{staticClass:"custom-block warning"},[a("p",[s._v("注意:  以上只对之后新增的用户有效, 如果要修改已存在的用户密码规则, 需要使用 "),a("code",[s._v("chage")]),s._v(" 命令")])]),s._v(" "),a("p",[s._v("使用以下命令, 可以查看用户的密码规则, "),a("code",[s._v("Command Format:")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("chage -l "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("userName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("code",[s._v("For Examlpe:")]),s._v(" "),a("br")]),s._v(" "),a("p",[a("img",{attrs:{src:"http://oss-blog.test.upcdn.net/redhat-reinforce-1.png",alt:"RedHat 系统安全加固"}})]),s._v(" "),a("h2",{attrs:{id:"chage-命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#chage-命令"}},[s._v("#")]),s._v(" chage 命令")]),s._v(" "),a("p",[s._v("设置最大最小使用天数, 以及警告天数, "),a("code",[s._v("For Examlpe:")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("chage -M "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("90")]),s._v(" -m "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" -W "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("userName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("div",{staticClass:"custom-block warning"},[a("p",[s._v("注意:  不要用该命令给 root 用户加上有效期, 如果密码过期, 再加上后文说的 "),a("code",[s._v("/etc/shadow")]),s._v(" 文件加锁禁止修改, 会导致 root 提示修改密码, 无法成功修改密码, 从而无法登陆。")])]),s._v(" "),a("p",[a("code",[s._v("chage")]),s._v(" 选项解释")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("-m")]),s._v(" => 密码可更改的最小天数。 为零时代表任何时候都可以更改密码。")]),s._v(" "),a("li",[a("strong",[s._v("-M")]),s._v(" => 密码保持有效的最大天数。")]),s._v(" "),a("li",[a("strong",[s._v("-w")]),s._v(" => 用户密码到期前, 提前收到警告信息的天数。")]),s._v(" "),a("li",[a("strong",[s._v("-E")]),s._v(" => 帐号到期的日期。 过了这天, 此帐号将不可用。")]),s._v(" "),a("li",[a("strong",[s._v("-d")]),s._v(" => 上一次更改的日期。")]),s._v(" "),a("li",[a("strong",[s._v("-i")]),s._v(" => 停滞时期。 如果一个密码已过期这些天, 那么此帐号将不可用。")]),s._v(" "),a("li",[a("strong",[s._v("-l")]),s._v(" => 例出当前的设置。 由非特权用户来确定他们的密码或帐号何时过期。")])]),s._v(" "),a("p",[s._v("如果要修改密码过期时间为 "),a("code",[s._v("“从不”")]),s._v(" , "),a("code",[s._v("For Examlpe:")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("chage -M "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("99999")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("userName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"空密码检查"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#空密码检查"}},[s._v("#")]),s._v(" 空密码检查")]),s._v(" "),a("p",[a("strong",[s._v("/etc/shadow")]),s._v(" 文件中的记录行与 "),a("strong",[s._v("/etc/passwd")]),s._v(" 中的一一对应, 是记录系统中用户的密码的, 此文件只有 "),a("code",[s._v("root")]),s._v(" 用户可以对其进行修改")]),s._v(" "),a("p",[s._v("使用 "),a("code",[s._v("awk")]),s._v(" 命令可以检查是否存在空密码, "),a("code",[s._v("For Examlpe:")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" -F "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("':'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'("),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$2")]),s._v('==""){print '),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v("}'")]),s._v(" /etc/shadow\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"没密码检查"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#没密码检查"}},[s._v("#")]),s._v(" 没密码检查")]),s._v(" "),a("p",[s._v("空密码跟没有密码是俩回事, 体现于 "),a("strong",[s._v("/etc/shadow")]),s._v(" 中的密码那一列, 空密码是显示空, 没有密码是显示 "),a("code",[s._v("！ ！")])]),s._v(" "),a("p",[s._v("使用 "),a("code",[s._v("awk")]),s._v(" 命令可以检查是否存在空密码, "),a("code",[s._v("For Examlpe:")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" -F "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("':'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'("),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$2")]),s._v('=="！ ！ "){print '),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v("}'")]),s._v(" /etc/shadow\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"awk-命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#awk-命令"}},[s._v("#")]),s._v(" awk 命令")]),s._v(" "),a("p",[s._v("查询 UID 为 0 的用户, "),a("code",[s._v("For Examlpe:")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" -F "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("':'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'("),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$3")]),s._v("==0){print "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v("}'")]),s._v(" /etc/passwd\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("div",{staticClass:"custom-block tip"},[a("p",[s._v("UID 为 0 的任何用户都拥有系统的最高特权, 保证只有 root 用户的 UID 为 0")])]),s._v(" "),a("p",[a("code",[s._v("awk")]),s._v(" 选项解释")]),s._v(" "),a("ul",[a("li",[a("strong",[a("code",[s._v("-F fs")])]),s._v(" => fs 指定输入分隔符, fs 可以是字符串或正则表达式, 如 "),a("code",[s._v("-F:")])]),s._v(" "),a("li",[a("strong",[a("code",[s._v("-v var=value")])]),s._v(" => 赋值一个用户定义变量, 将外部变量传递给 "),a("code",[s._v("awk")])]),s._v(" "),a("li",[a("strong",[a("code",[s._v("-f scripfile")])]),s._v(" => 从脚本文件中读取 awk 命令")]),s._v(" "),a("li",[a("strong",[a("code",[s._v("-m[fr] val")])]),s._v(" => 对 val 值设置内在限制, "),a("code",[s._v("-mf")]),s._v(" 选项限制分配给 val 的最大块数目; "),a("code",[s._v("-mr")]),s._v(" 选项限制记录的最大数目。 这两个功能是 Bell 实验室版 "),a("code",[s._v("awk")]),s._v(" 的扩展功能, 在标准 "),a("code",[s._v("awk")]),s._v(" 中不适用。")])]),s._v(" "),a("h2",{attrs:{id:"密码复杂度"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#密码复杂度"}},[s._v("#")]),s._v(" 密码复杂度")]),s._v(" "),a("p",[s._v("redhat 公司专门开发了 "),a("code",[s._v("cracklib")]),s._v(" 这个安装包来判断密码的复杂度。")]),s._v(" "),a("p",[s._v("检查是否安装了 "),a("code",[s._v("cracklib")]),s._v(" 模块")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" -qa "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" cracklib\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("img",{attrs:{src:"http://oss-blog.test.upcdn.net/redhat-reinforce-3.png",alt:"RedHat 系统安全加固"}})]),s._v(" "),a("p",[s._v("在 "),a("code",[s._v("/etc/pam.d/system-auth")]),s._v(" 中修改")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("password requisite pam_cracklib.so try_first_pass retry = 3 difok = 3 minlen = 8 dcredit = -1 ucredit = -1 lcredit = -1 ocredit = -1\npassword sufficient pam_unix.so md5 shadow nullok try_first_pass use_authtok remember = 5\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[a("img",{attrs:{src:"http://oss-blog.test.upcdn.net/redhat-reinforce-4.png",alt:"RedHat 系统安全加固"}})]),s._v(" "),a("h3",{attrs:{id:"参数说明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参数说明"}},[s._v("#")]),s._v(" 参数说明")]),s._v(" "),a("ul",[a("li",[a("strong",[a("code",[s._v("retry=N")])]),s._v(" => 改变输入密码的次数, 默认值是 1, 一般设置为 3。 就是说, 如果用户输入的密码强度不够可以重复输入的次数。")]),s._v(" "),a("li",[a("strong",[a("code",[s._v("minlen=N")])]),s._v(" => 密码最小长度（除了 "),a("code",[s._v("credit")]),s._v(" 信用度的字符长度以外）")]),s._v(" "),a("li",[a("strong",[a("code",[s._v("dcredit=N")])]),s._v(" => 密码中至少 "),a("code",[s._v("(N<0)")]),s._v(" 或至多 "),a("code",[s._v("(N>=0)")]),s._v(" 有几个数字")]),s._v(" "),a("li",[a("strong",[a("code",[s._v("ucredit=N")])]),s._v(" => 密码中至少 "),a("code",[s._v("(N<0)")]),s._v(" 或至多 "),a("code",[s._v("(N>=0)")]),s._v(" 有几个大写字母")]),s._v(" "),a("li",[a("strong",[a("code",[s._v("lcredit=N")])]),s._v(" => 密码中至少 "),a("code",[s._v("(N<0)")]),s._v(" 或至多 "),a("code",[s._v("(N>=0)")]),s._v(" 有几个小写字母")]),s._v(" "),a("li",[a("strong",[a("code",[s._v("ocredit=N")])]),s._v(" => 密码中至少 "),a("code",[s._v("(N<0)")]),s._v(" 或至多 "),a("code",[s._v("(N>=0)")]),s._v(" 有几个特殊字符")]),s._v(" "),a("li",[a("strong",[a("code",[s._v("difok=M")])]),s._v(" => 新密码与前一个旧密码之间至少有 M 个字符不相同")])]),s._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",[s._v("注意: "),a("code",[s._v("dcredit")]),s._v(" 、 "),a("code",[s._v("ucredit")]),s._v(" 、 "),a("code",[s._v("lcredit")]),s._v(" 、 "),a("code",[s._v("ocredit")]),s._v(" 为信用度字符, 如果 "),a("code",[s._v("N<0")]),s._v(" , 表示至少, 则新密码长度最小长度就等于 minlen.。 而当 "),a("code",[s._v("N>0")]),s._v(" 时, 表示至多, 比如 "),a("code",[s._v("ocredit=1")]),s._v(" , 至多有一个特殊字符, 这样的话, 即使没有特殊字符也会允许设置新密码。 还有, 此时新密码长度会大于 minlen。 算法交复杂, 这里不赘述。 因此, 通常情况下推荐使用 "),a("code",[s._v("N<0")]),s._v(" 来做密码复杂度限制。 另外, 此密码规则对 root 用户无效, 只针对普通用户修改自身密码")])]),s._v(" "),a("h2",{attrs:{id:"登录验证规则"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#登录验证规则"}},[s._v("#")]),s._v(" 登录验证规则")]),s._v(" "),a("h3",{attrs:{id:"记录普通用户登录失败次数并锁定用户"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#记录普通用户登录失败次数并锁定用户"}},[s._v("#")]),s._v(" 记录普通用户登录失败次数并锁定用户")]),s._v(" "),a("p",[s._v("在 ** "),a("code",[s._v("/etc/pam.d/system-auth**")]),s._v(" 中 "),a("code",[s._v('"#%PAM-1.0"')]),s._v(" 下面一行加入, "),a("code",[s._v("For Example:")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("auth required pam_tally2.so deny = 3 unlock_time = 300\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("div",{staticClass:"custom-block warning"},[a("p",[s._v("注意:  一定要加在 "),a("code",[s._v("#%PAM-1.0")]),s._v(" 下面一行")])]),s._v(" "),a("p",[s._v("参数说明")]),s._v(" "),a("ul",[a("li",[a("strong",[a("code",[s._v("deny[=n]")])]),s._v(" => 用户连续错误登陆的最大次数, 超过则锁定")]),s._v(" "),a("li",[a("strong",[a("code",[s._v("unlock_time")])]),s._v(" => 设定普通用户锁定后, 多少时间后解锁, 单位是秒")]),s._v(" "),a("li",[a("strong",[a("code",[s._v("even_deny_root")])]),s._v(" => 也限制 root 用户")]),s._v(" "),a("li",[a("strong",[a("code",[s._v("root_unlock_time[=n]")])]),s._v(" => 设定 root 用户锁定后, 多少时间后解锁, 单位是秒")]),s._v(" "),a("li",[a("strong",[a("code",[s._v("quiet")])]),s._v(" => 不对已锁定的用户发出提示信息")])]),s._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",[s._v("注意:  以上参数根据实际需要取舍, 如果使用了 even_deny_root 参数限制 root 用户登录错误次数, 而没有配置 root_unlock_time 的话, 一旦 root 用户被锁, 解锁将很麻烦。")])]),s._v(" "),a("h3",{attrs:{id:"查看用户登录失败次数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看用户登录失败次数"}},[s._v("#")]),s._v(" 查看用户登录失败次数")]),s._v(" "),a("p",[s._v("当登录错误次数达到最大限制后, 用户再次登录时, 会提示")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("Your account is locked.Maximum amount of failed attempts was reached.\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("img",{attrs:{src:"http://oss-blog.test.upcdn.net/redhat-reinforce-6.png",alt:"RedHat 系统安全加固"}})]),s._v(" "),a("p",[s._v("通过以下命令可以查看用户登录失败次数, "),a("code",[s._v("Command Format:")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("pam_tally2 -u "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("userName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("code",[s._v("For Example:")]),s._v(" "),a("br")]),s._v(" "),a("p",[a("img",{attrs:{src:"http://oss-blog.test.upcdn.net/redhat-reinforce-7.png",alt:"RedHat 系统安全加固"}})]),s._v(" "),a("h3",{attrs:{id:"解锁已经锁定的用户"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解锁已经锁定的用户"}},[s._v("#")]),s._v(" 解锁已经锁定的用户")]),s._v(" "),a("ul",[a("li",[s._v("自动解锁")])]),s._v(" "),a("p",[s._v("-- 如果配置了 "),a("code",[s._v("unlock_time")]),s._v(" 或 "),a("code",[s._v("root_unlock_time")]),s._v(" (针对 "),a("code",[s._v("root")]),s._v(" 用户)参数, 则等待超过这个时长后, 帐户会自动解锁")]),s._v(" "),a("ul",[a("li",[s._v("手动解锁:")])]),s._v(" "),a("p",[s._v("-- 只能以 "),a("code",[s._v("root")]),s._v(" 用户通过命令 "),a("code",[s._v("pam_tally2 -u [userName] -r")]),s._v(" 可以手动解锁因登录错误次数达到最大限制后自动锁定的用户, 同时登录错误次数会被重置为 0")]),s._v(" "),a("h2",{attrs:{id:"登录超时"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#登录超时"}},[s._v("#")]),s._v(" 登录超时")]),s._v(" "),a("p",[s._v("对于 bash 用户, 修改 "),a("code",[s._v("/etc/profile")]),s._v(" 或 "),a("code",[s._v("/etc/bashrc")]),s._v(" , 所有使用 bash 的用户都会继承, "),a("code",[s._v("For Example:")]),s._v(" "),a("br")]),s._v(" "),a("p",[a("img",{attrs:{src:"http://oss-blog.test.upcdn.net/redhat-reinforce-8.png",alt:"RedHat 系统安全加固"}})]),s._v(" "),a("p",[s._v("对于 csh 用户, 修改 "),a("code",[s._v("/etc/csh.cshrc")]),s._v(" , 所有使用 csh 的用户都会继承, "),a("code",[s._v("For Example:")]),s._v(" "),a("br")]),s._v(" "),a("p",[a("img",{attrs:{src:"http://oss-blog.test.upcdn.net/redhat-reinforce-9.png",alt:"RedHat 系统安全加固"}})]),s._v(" "),a("p",[s._v("对于 bash 用户, 修改 "),a("code",[s._v("/etc/profile")]),s._v(" 或 "),a("code",[s._v("/etc/bashrc")]),s._v(" , 所有使用 bash 的用户都会继承, "),a("code",[s._v("For Example:")]),s._v(" "),a("br")]),s._v(" "),a("p",[a("img",{attrs:{src:"http://oss-blog.test.upcdn.net/redhat-reinforce-8.png",alt:"RedHat 系统安全加固"}})]),s._v(" "),a("p",[s._v("对于 csh 用户, 修改 "),a("code",[s._v("/etc/csh.cshrc")]),s._v(" , 所有使用 csh 的用户都会继承, "),a("code",[s._v("For Example:")]),s._v(" "),a("br")]),s._v(" "),a("p",[a("img",{attrs:{src:"http://oss-blog.test.upcdn.net/redhat-reinforce-9.png",alt:"RedHat 系统安全加固"}})]),s._v(" "),a("h2",{attrs:{id:"ssh"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ssh"}},[s._v("#")]),s._v(" SSH")]),s._v(" "),a("h3",{attrs:{id:"禁止-root-用户远程-ssh-登录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#禁止-root-用户远程-ssh-登录"}},[s._v("#")]),s._v(" 禁止 root 用户远程 ssh 登录")]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",[s._v("由于之前的笔记已经记录过了, 这里就不再重复了")])]),s._v(" "),a("h3",{attrs:{id:"ssh-的黑白名单（指定用户或组）"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ssh-的黑白名单（指定用户或组）"}},[s._v("#")]),s._v(" ssh 的黑白名单（指定用户或组）")]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",[s._v("由于之前的笔记已经记录过了, 这里就不再重复了")])]),s._v(" "),a("h3",{attrs:{id:"ssh-的黑白名单（指定-ip）"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ssh-的黑白名单（指定-ip）"}},[s._v("#")]),s._v(" ssh 的黑白名单（指定 IP）")]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",[s._v("由于之前的笔记已经记录过了, 这里就不再重复了")])]),s._v(" "),a("h2",{attrs:{id:"telnet"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#telnet"}},[s._v("#")]),s._v(" Telnet")]),s._v(" "),a("h3",{attrs:{id:"禁止-root-用户远程-telnet-登录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#禁止-root-用户远程-telnet-登录"}},[s._v("#")]),s._v(" 禁止 root 用户远程 telnet 登录")]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",[s._v("系统安装 "),a("code",[s._v("telnet-server")]),s._v(" 服务后, 默认就是禁止 root 用户直接远程 telnet 登录的。 确认只要存在 "),a("code",[s._v("/etc/securetty")]),s._v(" 文件, 就可以限制 root 直接远程 telnet 登录。")])]),s._v(" "),a("h3",{attrs:{id:"telnet-的黑白名单（指定用户或组）"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#telnet-的黑白名单（指定用户或组）"}},[s._v("#")]),s._v(" telnet 的黑白名单（指定用户或组）")]),s._v(" "),a("p",[s._v("系统不支持限制普通用户 telnet 远程登录")]),s._v(" "),a("h3",{attrs:{id:"telnet-的黑白名单（指定-ip）"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#telnet-的黑白名单（指定-ip）"}},[s._v("#")]),s._v(" telnet 的黑白名单（指定 IP）")]),s._v(" "),a("p",[s._v("与 "),a("code",[s._v("SSH")]),s._v(" 中的相差无几, 同样是在 "),a("code",[s._v("/etc/hosts.allow")]),s._v(" 里添加白名单, 在 "),a("code",[s._v("/etc/hosts.deny")]),s._v(" 里添加黑名单, "),a("code",[s._v("For Example:")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("in .telnetd: 192.168 .1 .10 192.168 .1 .11# / etc / hosts.allow in .telnetd: ALL# / etc / hosts.deny\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"禁止普通用户登录-shell"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#禁止普通用户登录-shell"}},[s._v("#")]),s._v(" 禁止普通用户登录 shell")]),s._v(" "),a("p",[s._v("使用 "),a("code",[s._v("usermod")]),s._v(" 命令修改用户的登录 "),a("code",[s._v("shell")]),s._v(" 就好, "),a("code",[s._v("Command Format:")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("usermod")]),s._v(" -s /sbin/nologin "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("userName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"避免普通用户-su-到-root-用户"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#避免普通用户-su-到-root-用户"}},[s._v("#")]),s._v(" 避免普通用户 su 到 root 用户")]),s._v(" "),a("p",[s._v("在 ** "),a("code",[s._v("/etc/pam.d/su**")]),s._v(" 中 "),a("code",[s._v('"#%PAM-1.0"')]),s._v(" 下面一行加入")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("auth sufficient pam_rootok.so debug\nauth required pam_wheel.so group = wheel\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[a("img",{attrs:{src:"http://oss-blog.test.upcdn.net/redhat-reinforce-5.png",alt:"RedHat 系统安全加固"}})]),s._v(" "),a("p",[s._v("当然只去除红框中的 "),a("code",[s._v("#")]),s._v(" 也是 ok 的"),a("br")]),s._v(" "),a("p",[a("img",{attrs:{src:"http://oss-blog.test.upcdn.net/redhat-reinforce-10.png",alt:"RedHat 系统安全加固"}})]),s._v(" "),a("p",[s._v("这样以来只有 wheel 组的用户可以 su 作为 root")]),s._v(" "),a("h2",{attrs:{id:"指定可以-su-到-root-的用户"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#指定可以-su-到-root-的用户"}},[s._v("#")]),s._v(" 指定可以 su 到 root 的用户")]),s._v(" "),a("p",[s._v("指定某个用户可以 su 到 root 用户, 需要将该用户加入到 wheel 组中")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("usermod")]),s._v(" -G wheel "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("username"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("div",{staticClass:"custom-block warning"},[a("p",[s._v("注意, 如果禁止 root 用户直接登录, 也不存在 wheel 组的用户, 就无法进入 root 用户了")])]),s._v(" "),a("p",[a("img",{attrs:{src:"http://oss-blog.test.upcdn.net/redhat-reinforce-11.png",alt:"RedHat 系统安全加固"}})])])}),[],!1,null,null,null);t.default=r.exports}}]);